# Effective Shell for Pentesting

This repository contains practical ideas and concepts for working with shells (especially for pentesting).

### Content

* [Introduction](#introduction)
* [Overview](#overview)
* [Tools](#tools)
* [Principles](#principles)
* [Receipes](#recipes)

## Introduction

The following guide isn't intended to copy and paste only the content, but containing general principles and recipes to improve ones shell skills as well as to provide new ideas. The use of the presented items strongly depends on the experience in dealing with shells. 

If you're unfamiliar with Linux systems and the use of a shell, have a look at the [*LPIC Learning Materials*](https://learning.lpi.org/en/learning-materials/learning-materials/).

## Overview

Typically, the following two shells are preinstalled on Linux systems:

* [bash](https://www.gnu.org/software/bash/)
* [zsh](https://zsh.sourceforge.io/)

Besides the two mentioned, there are of course several more, including my personal favorite

* [fish](https://fishshell.com/)

Note that in following `bash` and `fish` are supported preferentially.

## Tools



* [Terminator](https://terminator-gtk3.readthedocs.io/en/latest/) - Terminual emulator including grid view for multiple terminals
* [tmux](https://github.com/tmux/tmux/wiki) - Terminal multiplexer
* [i3wm](https://i3wm.org/) - Tilling window manager

## Principles

### Item 1: KISS - Keep It Simple, Stupid

### Item 2: Everything is a file.

### Item 3: DRY - Donâ€™t Repeat Yourself

## Recipes

### Item 1: Use Shortcuts

Shells usually have a set of shortcuts that allow to perform operations within an interactive shell quickly. For example instead of typing `clear` the shortcut `Ctrl`+`L` will clean the screen (works for bash and fish).

For `bash` you can find shortcuts in chapter [Command-Line-Editing](https://www.gnu.org/software/bash/manual/bash.html#Command-Line-Editing) within the official documentation. Furthermore, the `bash` supports a feature called [bash bang](https://www.redhat.com/sysadmin/bash-bang-commands) allowing to access commands and parameters from history. 

Sample - Repeat the last command with `sudo` permissions
```
$ cp filename /usr/local/bin/filename
cp: cannot create regular file '/usr/local/bin/filename': Permission denied
$ sudo !!
sudo cp filename /usr/local/bin/filename
[sudo] password for joe: 
```

The `fish` shell also offers a lot of functionality via shortcuts, for example, `ALT` + `H` to open the manual page of current command - if a man page exists - or `Alt` + `S` for appending `sudo` at the beginning of current command line. A full list of provided shortcuts can be found [here](https://fishshell.com/docs/current/interactive.html#shared-bindings).

> Hint: Maybe you must turn off `ALT` key to activate menu bar in settings of the terminal emulator.

### Item 2: Multiple Commands

Certain commands always occur, or at least frequently occur, in combination. Some practical examples for the start:

Sample 1: Editing shell settings - Requires reload to enable recent changes. After exiting vim editor the changes are loaded immediately.
```bash
vim ~/.config/fish/config.fish; source ~/.config/fish/config.fish
```

Sample 2: Command cascade to push recent changes in git repository.
```bash
git add --all; git commit -m "<Commit Message>"; git push
```

Several commands can be concatenated by ";". The shell will run them independently of the return value in the given order from left to right.

Sample 3: Check if folder exists and print message if folder exists
```bash
$ test -d /tmp && echo "Folder exists"
Folder exists
$ test -d /test && echo "Folder exists"
[Empty Output]
```
A well-known example of combining commands with logical operators is updating software packages.

Sample 3: Update software packages - `apt upgrade` is only performed, if `apt update` was finishing successfull
```
$ sudo apt update && sudo apt upgrade
...
```

It also has the advantage that commands occur together in the shell history. 

### Item 3: Use Aliases


### Item 4: Use Environment Variables


### Item 5: Prefill Shell History

```
$ cat commands.txt
vim ~/.bashrc; source ~/.bashrc
$ cp commands.txt ~/.bash_history
```

### Item 6: Write Scripts



### Item 7: Define Functions for Shell Operations

