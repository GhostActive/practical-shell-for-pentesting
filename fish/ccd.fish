#
# GNU General Public License v3.0
#   
# Copyright (C) 2021 GhostActive
#
# Author
#    GhostActive, https://github.com/ghostactive
#
# Version
#    1.0
#

function ccd -d "Create and change directory; If directory already exists, than only change."
    
    # Print help text
    if contains -- "-h" $argv; or contains -- "--help" $argv
        echo ""
        echo "ccd - Create and change directory"
        echo ""
        echo "    Usage: ccd [DIRECTORY]"
        echo ""
        echo "DESCRIPTION"
        echo "    'Atomic operation' to create a new directory before changing to it."
        echo "    If the given directory already exists, than only change."
        echo ""
        echo "ARGUMENTS"
        echo "    -h, --help      Print this help message"
        echo ""
        echo "EXAMPLES"
        echo "    # Goto home directory of current user"
        echo "    ccd"
        echo ""
        echo "    # Change to directory 'Workspace'"
        echo "    ccd Workspace"
        return 0
    end

    set LENGTH (count $argv)

    # No parameter - goto home directory
    if test $LENGTH -eq 0
        cd
        return 0
    end

    # Check number of parameter
    if test $LENGTH -gt 1
        echo "An error occurred: Too many arguments (count: $LENGTH) '$argv'"
        return 1
    end

    # Check whether special paths are used
    switch $argv
        case .
            cd .        # Change to current directory - do nothing
            return 0
        case ..
            cd ..       # Change to parent directory
            return 0
        case ~
            cd ~        # Change to home directory
            return 0
        case -
            cd -        # Change to last directory
            return 0
    end
    
    # Check whether directory exists
    if test ! -d $argv
        mkdir -p $argv
    end

    cd $argv

    return 0
end
